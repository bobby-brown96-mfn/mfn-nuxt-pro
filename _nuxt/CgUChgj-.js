import{G as d,E as K,r as S,Y as b,bU as _}from"./DgP3qxNX.js";import{u as w}from"./OJkHrvbi.js";function g(...a){return d(()=>a.every(o=>K(o)))}function D(a){return d(()=>!K(a))}const $=/^[^-]+.*-.*[^-]+$/,j=/^[^_]+.*_.*[^_]+$/,E=(a,o={})=>{const{macOS:m,usingInput:h}=w();let u=[];const c=S([]),r=()=>{c.value.splice(0,c.value.length)},v=b(r,o.chainDelay??800),I=e=>{if(!e.key)return;const l=/^[a-z]{1}$/i.test(e.key);let t;if(c.value.push(e.key),c.value.length>=2){t=c.value.slice(-2).join("-");for(const n of u.filter(i=>i.chained))if(n.key===t){n.condition.value&&(e.preventDefault(),n.handler()),r();return}}for(const n of u.filter(i=>!i.chained))if(e.key.toLowerCase()===n.key&&e.metaKey===n.metaKey&&e.ctrlKey===n.ctrlKey&&!(l&&e.shiftKey!==n.shiftKey)){n.condition.value&&(e.preventDefault(),n.handler()),r();return}v()};u=Object.entries(a).map(([e,l])=>{var y,p;if(!l)return null;let t;e.includes("-")&&e!=="-"&&!((y=e.match($))!=null&&y.length)&&console.trace(`[Shortcut] Invalid key: "${e}"`),e.includes("_")&&e!=="_"&&!((p=e.match(j))!=null&&p.length)&&console.trace(`[Shortcut] Invalid key: "${e}"`);const n=e.includes("-")&&e!=="-";if(n)t={key:e.toLowerCase(),metaKey:!1,ctrlKey:!1,shiftKey:!1,altKey:!1};else{const s=e.toLowerCase().split("_").map(f=>f);t={key:s.filter(f=>!["meta","ctrl","shift","alt"].includes(f)).join("_"),metaKey:s.includes("meta"),ctrlKey:s.includes("ctrl"),shiftKey:s.includes("shift"),altKey:s.includes("alt")}}if(t.chained=n,!m.value&&t.metaKey&&!t.ctrlKey&&(t.metaKey=!1,t.ctrlKey=!0),typeof l=="function"?t.handler=l:typeof l=="object"&&(t={...t,handler:l.handler}),!t.handler)return console.trace("[Shortcut] Invalid value"),null;const i=[];return l.usingInput?typeof l.usingInput=="string"&&i.push(d(()=>h.value===l.usingInput)):i.push(D(h)),t.condition=g(...i,...l.whenever||[]),t}).filter(Boolean),_("keydown",I)};export{E as d};
